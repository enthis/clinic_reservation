Clinic Reservation AppThis is a web application for managing clinic appointments, built with Laravel, FilamentPHP, Livewire, and integrated with Midtrans for payments and Spatie for role-based access control.Table of ContentsFeaturesPrerequisitesInstallation Guide1. Clone the Repository2. Install Composer Dependencies3. Environment Configuration4. Database Setup5. Generate Application Key6. Run Migrations and Seeders7. Install Node.js Dependencies (Optional, for frontend assets)8. Link Storage (Optional)Running the ApplicationStart Development ServerAccessing the ApplicationKey Credentials & AccessAdmin Panel AccessMidtrans Sandbox CredentialsMidtrans Dashboard SetupTroubleshootingFeaturesUser Authentication:Google Login (via Laravel Socialite)Email/Password Login (via API, for decoupled frontends)Role-Based Access Control (RBAC) using Spatie Laravel Permission.Multi-step Reservation Flow:Select Service.Select Doctor.Select available Day and Time Slot (dynamic filtering).Confirmation.Payment Integration:Midtrans Snap (popup payment gateway).Asynchronous Webhook handling for payment status updates.Manual "Check Status" button for pending payments.Admin Panel (FilamentPHP):Comprehensive CRUD for Users, Services, Doctors, Schedules, Reservations, Payments, Prescription Items, Recipes, Doctor Notes, Payment Gateway Configurations.Role-specific views and disabled fields for Doctors.Automated payment_amount recalculation for reservations based on prescribed items."Recalculate Amount" action for Reservations."Login as User" impersonation feature for Admins.Database Design: Normalized schema with clear relationships (ERD to be provided separately).PrerequisitesBefore you begin, ensure you have the following installed on your system:PHP: Version 8.2 or higher.Composer: Latest stable version.Node.js & npm (or Yarn): Latest stable version (optional, but recommended for frontend asset compilation).MySQL Database Server: Or any other database supported by Laravel (e.g., PostgreSQL, SQLite).Git: For cloning the repository.Installation GuideFollow these steps to get the project up and running on your local machine.1. Clone the Repositorygit clone [YOUR_REPOSITORY_URL] clinic-reservation-app
cd clinic-reservation-app
2. Install Composer Dependenciescomposer install
3. Environment ConfigurationCreate your environment file by copying the example file:cp .env.example .env
cp .env.example .env.testing # For testing environment
Now, open .env and .env.testing files and configure your database and application settings:.env (Development Environment):APP_NAME="Clinic Reservation"
APP_ENV=local
APP_KEY=
APP_DEBUG=true
APP_URL="http://localhost:8000" # Or your local domain
APP_TIMEZONE="Asia/Jakarta" # Important for date/time consistency

DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=clinic_reservation # Your database name
DB_USERNAME=root # Your database username
DB_PASSWORD= # Your database password

# Google OAuth Credentials (from Google Cloud Console)
GOOGLE_CLIENT_ID="YOUR_GOOGLE_CLIENT_ID"
GOOGLE_CLIENT_SECRET="YOUR_GOOGLE_CLIENT_SECRET"
GOOGLE_REDIRECT_URI="${APP_URL}/auth/google/callback"
.env.testing (Testing Environment):Ensure this uses a separate database to avoid conflicts with your development data.APP_ENV=testing
DB_DATABASE=clinic_reservation_test # A dedicated database for tests
# ... other settings similar to .env
4. Database SetupEnsure your MySQL server is running and you have created the databases specified in DB_DATABASE in both .env and .env.testing.5. Generate Application KeyThis command generates a unique application key, which is essential for security.php artisan key:generate
6. Run Migrations and SeedersThis command will create all necessary tables in your database and populate them with initial data (users, roles, services, doctors, schedules, payment gateway configs).php artisan migrate:fresh --seed
Important: This command will delete all existing data in your configured database before re-creating tables and seeding. Use with caution in production.7. Install Node.js Dependencies (Optional, for frontend assets)If you plan to modify or compile frontend assets (e.g., custom CSS, JavaScript beyond Livewire/Tailwind CDN), you'll need Node.js and npm/Yarn.npm install # or yarn install
npm run dev # or npm run build for production assets
8. Link Storage (Optional)If your application uses file storage (e.g., for user avatars, uploaded documents), create a symbolic link:php artisan storage:link
Running the ApplicationStart Development Serverphp artisan serve
This will typically start the server at http://localhost:8000.Accessing the ApplicationLanding Page: http://localhost:8000User Dashboard (after login): http://localhost:8000/dashboardFilament Admin Panel: http://localhost:8000/adminKey Credentials & AccessThe php artisan migrate:fresh --seed command populates your database with default users and configurations:Admin Panel AccessAdmin User:Email: admin@example.comPassword: passwordSpecial Admin User:Email: nharits74@gmail.comPassword: passwordStaff User:Email: staff@example.comPassword: passwordDoctor User (linked to Dr. Alice Smith):Email: doctor1@example.comPassword: passwordDoctor User (linked to Dr. Bob Johnson):Email: doctor2@example.comPassword: passwordRegular User (for frontend booking):Email: user@example.comPassword: passwordMidtrans Sandbox CredentialsThese are automatically seeded into your payment_gateway_configs table for sandbox mode.Merchant ID: G875131585Client Key: SB-Mid-client-KEnuu62UKFDhFolJServer Key: SB-Mid-server-m1D0PCtdL_XdCyYo9osSSMEeMidtrans Dashboard SetupCrucial for Webhooks and Redirects to work!Log in to your Midtrans Sandbox Dashboard (or Production Dashboard if deploying) and navigate to Settings > Core API. Fill in the following URLs exactly:Payment Notification URL: https://clinic.enthistechproject.my.id/api/midtrans/callbackRecurring Notification URL: https://clinic.enthistechproject.my.id/api/midtrans/callbackPay Account Notification URL: https://clinic.enthistechproject.my.id/api/midtrans/callbackFinish Redirect URL: https://clinic.enthistechproject.my.id/reservation/{reservation_id}/payment/finishUnfinish Redirect URL: https://clinic.enthistechproject.my.id/reservation/{reservation_id}/payment/unfinishError Redirect URL: https://clinic.enthistechproject.my.id/reservation/{reservation_id}/payment/errorNote: If testing locally with http://localhost:8000, you will need to use a tunneling service like ngrok to expose your local server to the internet so Midtrans can send webhooks. Your ngrok URL would replace https://clinic.enthistechproject.my.id in the above URLs.Troubleshootingcomposer install or npm install errors: Check your PHP/Node.js versions and internet connection.php artisan migrate:fresh --seed errors:Ensure your database server (MySQL) is running.Verify your database credentials (DB_DATABASE, DB_USERNAME, DB_PASSWORD) in .env are correct.Make sure the database specified in DB_DATABASE actually exists."Class '...' not found" or "Target class [App\Http\Controllers...] does not exist.":Run composer dump-autoloadRun php artisan optimize:clear"Route [...] not defined" or 404/405 errors on API calls:Run php artisan route:clear and php artisan optimize:clear.Ensure the HTTP method (GET/POST) in your fetch request matches the route definition in routes/api.php.Verify SANCTUM_STATEFUL_DOMAINS in config/sanctum.php includes localhost:8000 (or your domain).Check app/Http/Middleware/VerifyCsrfToken.php for webhook URL exclusions."Unauthenticated." JSON response on API calls:Verify SANCTUM_STATEFUL_DOMAINS in config/sanctum.php is correct.Ensure Accept: application/json and X-CSRF-TOKEN headers are sent with your AJAX requests.Check app/Http/Middleware/Authenticate.php's redirectTo method.Midtrans popup not appearing or "Halaman Tidak Tersedia":Check your browser's developer console for JavaScript errors.Verify data-client-key in landing-page.blade.php points to config('services.midtrans.client_key').Check Laravel logs (storage/logs/laravel.log) for Midtrans Snap Error.Ensure APP_ENV in .env matches the mode of your Midtrans keys (sandbox/production).Payment status not updating after Midtrans payment:Check Laravel logs (storage/logs/laravel.log) for Notification: Webhook received.Check Midtrans Dashboard's Transaction Logs for webhook delivery status (e.g., 200 OK, 500, etc.).Ensure api/midtrans/callback is excluded from CSRF verification in app/Http/Middleware/VerifyCsrfToken.php.If testing locally, ensure ngrok (or similar) is running and configured correctly for webhooks.